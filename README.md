# Barrier options pricing
透過蒙地卡羅和二元樹(CRR model)對障礙選擇權定價
## 選擇權種類(以下4種組合，共16個)
1.  **歐式或美式**
2.  **上方或下方**
3.  **入局或出局**
4.  **買權或賣權**
## Barrier options - CRR
透過二元樹(CRR model)對障礙選擇權定價
### code重點說明
1.  **code分為4大區塊**
  - 區塊1 : 歐式選擇權
  - 區塊 2 :美式選擇權
  - 驗證區塊1和2計算是否正確
  - CRR model收斂情況
2.  **歐美式差異**
  -  在計算每一期選擇權價值時美式選擇權需要額外一個變數存放履約價值
3.  **上方和下方的差異**
  -  判斷是否入局(出局)的情境關係不同
4.  **入局和出局的差異**
  - 出局 : 若第t期股價觸碰到障礙價格，則選擇權價值=0
  - 入局 :
    - 每一期要分別計算與存取未入局和入局的選擇權價值
    - 需額外判斷期初選擇權是否有入局(按code寫法若不加此判斷，只要期初未入局選擇權便會直接=0)
5.  **買賣權差異**
  -  選擇權價值計算方式不同
6.  **如何驗證歐式選擇權計算是否正確**
  - 透過障礙選擇權組合是否等價陽春歐式選擇權(以Black-Scholes model計算)
    - 上出局call + 上入局call = 陽春call
    - 上出局put + 上入局put = 陽春put
    - 下出局call + 下入局call = 陽春call
    - 下出局put + 下入局put = 陽春put
  - 以數學方式推導上述等式(以上出局call + 上入局call = 陽春call為例)
    -  上出局call收益 =  { max(St - K, 0) if St < H, 0 if St >= H }
    -  上入局call收益 =  { 0 if St < H, max(St - K, 0) if St >= H }
    -  陽春call收益 = max(St - K, 0)
    -  上出局收益 + 下出局收益 = { max(St - K, 0) if St < H, max(St - K, 0) if St >= H } = max(St - K, 0) = 陽春call收益 QED
7.  **如何驗證美式選擇權計算是否正確**
  -  方法1 : 透過歐美式關係「歐式call = 美式call；歐式put <= 美式put」
  -  方法2 : 透過障礙選擇權組合是否等價陽春美式選擇權(以CRR model計算)，方法和概念與重點6雷同
8.  **CRR收斂成鋸齒狀**
  -  原因 : 使用二元樹(CRR)計算障礙價格時，有效障礙價格不一定能剛好切在樹的節點上
  -  修正 : 改使用三元樹，相比二元樹，三元樹多一個自由度可以去控制樹擴張的大小，使每一期都有一個節點剛好落在有效障礙價格上

## Barrier options - Monte-Carlo
透過蒙地卡羅模擬股價路徑進行障礙選擇權定價
### code重點說明
1.  **與CRR model相比，額外需要『股票報酬率』這個參數**
